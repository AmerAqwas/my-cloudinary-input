(this["webpackJsonphygraph-uix-cloudinary-input"]=this["webpackJsonphygraph-uix-cloudinary-input"]||[]).push([[0],{215:function(e,i,n){"use strict";n.r(i);var t=n(0),o=n.n(t),c=n(89),l=n.n(c),r=(n(97),n(39)),a=n(92),d=n(27),s=n(12),u=n(90),p=n(4),x=n(6),b=n(1);function j(e){return Boolean(e)&&"public_id"in e&&"resource_type"in e}function f(e){return Array.isArray(e)&&e.length>0&&e.every((function(e){return j(e)}))}var h={extensionType:x.ExtensionType.field,fieldType:x.FieldExtensionType.JSON,name:"Cloudinary asset",description:"Pick asset object in Cloudinary",features:[x.FieldExtensionFeature.FieldRenderer,x.FieldExtensionFeature.ListRenderer,x.FieldExtensionFeature.TableRenderer],config:{CLOUD_NAME:{displayName:"Cloudinary cloud name",type:x.ConfigType.string,required:!0},API_KEY:{displayName:"Cloudinary public api key",type:x.ConfigType.string,required:!0}}};function y(){}function g(){return Object(x.useFieldExtension)().isTableCell?Object(b.jsx)(O,{}):Object(b.jsx)(m,{})}function m(){var e=Object(x.useFieldExtension)(),i=e.value,n=e.field.isList,c=e.onChange,l=e.onFocus,r=e.onBlur,a=e.expand,s=e.isExpanded,u=e.openDialog,p=e.extension.config,j=Object(t.useState)(!1),h=Object(d.a)(j,2),y=h[0],g=h[1];Object(t.useEffect)((function(){g(!1)}),[s]);var m=o.a.useState(),O=Object(d.a)(m,2),_=O[0],C=O[1],E=Array.isArray(i)?i.length>0:Boolean(i);return Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"10px",opacity:y?0:1},children:[s?null:Object(b.jsx)("button",{style:{cursor:"pointer",marginBottom:"10px",boxSizing:"border-box",userSelect:"none",color:"#6663FD",backgroundColor:"#F2F1FF",textAlign:"center",lineHeight:"16px",display:"inline-flex",border:"0px",borderRadius:"4px",fontWeight:600,fontFamily:'Inter, -apple-system, system-ui, "Segoe UI", Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"middle",padding:"8px"},onClick:function(){l(),u("/cloudinary",{maxWidth:"90vw",isList:n,media:i}).then((function(e){e&&c(e),r()}))},children:"Choose from Cloudinary"}),E&&(f(i)?i.map((function(e,n){return Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",opacity:s&&e.public_id!==(null===_||void 0===_?void 0:_.public_id)?0:1},children:[Object(b.jsx)(v,{cloudName:String(p.CLOUD_NAME),media:e,isExpanded:e.public_id===(null===_||void 0===_?void 0:_.public_id)&&s,onOpen:function(){a(!0),g(!0),C(e)},onClose:function(){a(!1),g(!0),C(void 0)}}),Object(b.jsx)("button",{style:{marginLeft:"10px",cursor:"pointer",boxSizing:"border-box",userSelect:"none",color:"#6663FD",backgroundColor:"transparent",textAlign:"center",lineHeight:"14px",display:"inline-flex",border:"0px",fontWeight:500,fontFamily:"sans-serif",fontSize:"12px",verticalAlign:"middle",padding:"4px"},onClick:function(){var n=i.filter((function(i){return i.public_id!==e.public_id}));c(n)},children:"X"})]},e.public_id+n)})):Object(b.jsx)(v,{cloudName:String(p.CLOUD_NAME),isExpanded:i.public_id===(null===_||void 0===_?void 0:_.public_id)&&s,onOpen:function(){a(!0),g(!0),C(i)},onClose:function(){a(!1),g(!0),C(void 0)},media:i}))]})}function O(){var e=Object(x.useFieldExtension)(),i=e.value,n=e.isExpanded,o=e.expand,c=e.field.isList,l=e.extension.config,r=Object(t.useState)(!1),a=Object(d.a)(r,2),s=a[0],u=a[1];return Object(t.useEffect)((function(){u(!1)}),[n]),(Array.isArray(i)?0===i.length:!1===Boolean(i))?null:n&&c?Object(b.jsx)(C,{cloudName:String(l.CLOUD_NAME),media:i,closeModal:function(){o(!1),u(!0)}}):Object(b.jsx)("div",{style:{display:"flex",opacity:s?0:1},children:f(i)?i.map((function(e,n){return Object(b.jsx)("div",{style:{width:59,height:59,marginRight:n===i.length-1?0:10},children:Object(b.jsx)(_,{cloudName:String(l.CLOUD_NAME),media:e,onOpen:function(){o(!0),u(!0)},isExpanded:!1,onClose:y})},e.public_id+n)})):Object(b.jsx)("div",{style:{width:59,height:59},children:Object(b.jsx)(_,{cloudName:String(l.CLOUD_NAME),isExpanded:n,onClose:function(){o(!1),u(!0)},onOpen:function(){o(!0),u(!0)},media:i})})})}function v(e){var i=e.media,n=e.onOpen,t=e.onClose,o=e.isExpanded,c=e.cloudName;return o?Object(b.jsx)(E,{cloudName:c,media:i,onClose:t}):"image"===i.resource_type?Object(b.jsx)("button",{onClick:n,style:{border:"none",outline:"none",background:"transparent",cursor:"pointer"},children:Object(b.jsx)(s.a,{cloudName:c,publicId:i.public_id,width:"400",crop:"scale",children:Object(b.jsx)(s.b,{})})}):"video"===i.resource_type?Object(b.jsx)(s.c,{cloudName:c,publicId:i.public_id,width:"400",controls:!0}):null}function _(e){var i=e.isExpanded,n=e.media,t=e.onOpen,o=e.onClose,c=e.cloudName,l=e.style;return i?Object(b.jsx)(E,{media:n,onClose:o,cloudName:c}):Object(b.jsx)("div",{tabIndex:0,onClick:t,onKeyPress:function(e){"Enter"===e.key&&t()},style:Object(a.a)({width:59,height:59,flexShrink:0},l),children:"image"===n.resource_type?Object(b.jsx)(s.a,{publicId:n.public_id,cloudName:c,width:"auto",crop:"scale",style:{objectFit:"cover",width:"100%",height:"100%",cursor:"pointer"},children:Object(b.jsx)(s.b,{})}):"video"===n.resource_type?Object(b.jsx)(s.c,{cloudName:c,publicId:n.public_id,width:"auto",style:{objectFit:"cover",width:"100%",height:"100%",cursor:"pointer"}}):null})}function C(e){var i=e.closeModal,n=e.media,o=e.cloudName,c=Object(t.useState)(null),l=Object(d.a)(c,2),r=l[0],a=l[1];return r?Object(b.jsx)(_,{cloudName:o,media:r,isExpanded:!0,onOpen:y,onClose:function(){a(null)}}):Object(b.jsx)("div",{"aria-modal":"true",role:"dialog",style:{position:"fixed",inset:0,display:"flex"},onClick:i,children:Object(b.jsxs)("div",{style:{margin:"auto"},onClick:function(e){e.stopPropagation()},children:[Object(b.jsx)(w,{closeModal:i}),Object(b.jsx)("div",{style:{display:"flex",borderRadius:"4px",backgroundColor:"white",maxWidth:"800px",maxHeight:"400px",padding:"16px",overflowY:"auto"},children:n.map((function(e,i){return Object(b.jsx)(_,{isExpanded:!1,cloudName:o,media:e,onOpen:function(){a(e)},onClose:function(){a(null)},style:{width:250,height:200,marginRight:i===n.length-1?0:16}},e.public_id+i)}))})]})})}function E(e){var i=e.media,n=e.cloudName,o=e.onClose;return Object(t.useEffect)((function(){var e=function(e){"Escape"===e.key&&o()};return window.addEventListener("keyup",e),function(){window.removeEventListener("keyup",e)}}),[o]),Object(b.jsxs)("div",{"aria-modal":"true",role:"dialog",style:{position:"fixed",inset:0,display:"flex",alignItems:"center",overflow:"auto"},onClick:function(e){e.stopPropagation(),o()},children:[Object(b.jsx)(w,{closeModal:o}),"image"===i.resource_type?Object(b.jsx)(s.a,{cloudName:n,publicId:i.public_id,width:"auto",style:{maxWidth:"100%",margin:"auto",maxHeight:"100%"},crop:"scale",children:Object(b.jsx)(s.b,{})}):"video"===i.resource_type?Object(b.jsx)(s.c,{cloudName:n,publicId:i.public_id,controls:!0,style:{maxWidth:"70vw",margin:"auto",maxHeight:"100%"}}):null]})}function N(){var e=Object(x.useFieldExtension)().extension.config,i=Object(x.useUiExtensionDialog)(),n=i.onCloseDialog,o=i.isList,c=i.media;return Object(t.useLayoutEffect)((function(){window.cloudinary.createMediaLibrary({cloud_name:e.CLOUD_NAME,api_key:e.API_KEY,remove_header:!1,max_files:"10",multiple:o,insert_caption:"Add & close",inline_container:"#cloudinary_dialog",default_transformations:[[{quality:"auto"},{fetch_format:"auto"}],[{width:80,height:80,crop:"fill",gravity:"auto",radius:"max"},{fetch_format:"auto",quality:"auto"}]],integration:{type:"hygraph_cloudinary_extension",platform:"hygraph",version:1,environment:"prod"}},{hideHandler:function(){n()},insertHandler:function(e){if(o)if(f(c))n([].concat(Object(r.a)(c),Object(r.a)(e.assets)));else{var i=j(c)?[c].concat(Object(r.a)(e.assets)):e.assets;n(i)}else n(e.assets[0])}}).show()}),[e.API_KEY,e.CLOUD_NAME,o,c,n]),Object(b.jsx)("div",{id:"cloudinary_dialog",style:{height:"800px"}})}function w(e){var i=e.closeModal;return Object(b.jsx)("button",{type:"button",style:{cursor:"pointer",userSelect:"none",backgroundColor:"transparent",textAlign:"center",lineHeight:"16px",display:"inline-flex",border:"0px",position:"absolute",right:"10px",top:"10px",fontWeight:500,background:"white",color:"black",fontSize:"16px",borderRadius:"4px",padding:"4px 8px",verticalAlign:"middle",margin:0},onClick:function(e){e.preventDefault(),e.stopPropagation(),i()},onKeyPress:function(e){e.preventDefault(),e.stopPropagation(),"Enter"===e.key&&i()},children:"Close"})}var k=function(){return Object(b.jsx)(x.Wrapper,{declaration:h,children:Object(b.jsx)(u.a,{children:Object(b.jsxs)(p.c,{children:[Object(b.jsx)(p.a,{path:"/",exact:!0,children:Object(b.jsx)(g,{})}),Object(b.jsx)(p.a,{path:"/cloudinary",exact:!0,children:Object(b.jsx)(N,{})})]})})})};l.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(k,{})}),document.getElementById("root"))},97:function(e,i,n){}},[[215,1,2]]]);
//# sourceMappingURL=main.99f71493.chunk.js.map